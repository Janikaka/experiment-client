#!/usr/bin/env python3

import click
import requests
import random


def getConf(username, url):
	confURL = url + 'configurations'
	confHeaders = {'username':username}
	confPayload = {}
	r = requests.get(confURL, headers=confHeaders, json=confPayload)
	return r.json()['configurations']

def postEvent(username, value, url):
	eventsURL = url + 'events'
	eventsHearders = {'username':username}
	#if value is None:
	#	value = 
	randValue = random.randint(0, 10)
	eventsPayload = {'value': randValue}
	requests.post(eventsURL, headers=eventsHearders, json=eventsPayload)


@click.command()
@click.option('--username', multiple=True)
@click.option('--dataitems')
@click.option('--users')
@click.option('--url')
def login(username, dataitems, users, url):
	print(username)
	if username != None:
		conf = getConf(username, url)
		print("Configurations: %s" % conf)
		if dataitems != None:
			for i in range(int(dataitems)):
				postEvent(username, url)
	elif users != None:
		for i in range(int(users)):
			username = randomString()
			conf = getConf(username, url)
			print("Configurations: %s" % conf)
			if dataitems != None:
				for i in range(int(dataitems)):
					postEvent(username, url)
			else:
				for i in range(random.randint(10,30)):
					postEvent(username, url)


	

if __name__ == '__main__':
	login()

